# 17장. 스파크 배포 환경
- 스파크 애플리케이션 실행에 필요한 인프라 구조
+ 클러스터 배포 시 선택사항
+ 스파크가 지원하는 클러스터 매니저
+ 배포 시 고려사항과 배포 환경 설정
- 스파크 지원 클러스터 매니저는 유사하지만, 다양한 클러스터 구성 방법이 있음 -> 근본적인 차이점에 대해 설명
- 스파크가 지원하는 클러스터 매니저
+ 스탠드얼론 모드
	+ 스파크에 패키지 되어있는 클러스터 관리자, 가장 간단함
	+ 동적으로 자원 사용량 조절이 되지 않음, 여러 애플리케이션 동시 사용 X
+ 하둡 YARN
	+ 하둡에서 사용할 수 있는 클러스터 관리자, 장시간 실행되는 배치 작업에 최적화
	+ 자원 초과 사용할 경우 얀이 터져요!
+ 아파치 메소스(Mesos)
	+ 짧게 실행되고 없어지는 워크로드에 적합
	+ cluster configuration이 Yarn보다 유연하지 못함
[Remarks](https://blog.naver.com/chemicalatom/220886863538)

## 17.1 스파크 애플리케이션 실행을 위한 클러스터 환경
+ 설치형 클러스터
+ 공개 클라우드

### 17.1.1 설치형 클러스터 배포 환경
- 자체 데이터센터를 운영하는 조직에 적합 (Zeppelin)
- 설치형 클러스터 환경은 사용 중인 하드웨어를 완전히 제어할 수 있음 -> 워크로드의 성능을 최적화
+ 설치형 클러스터의 문제점
	+ 크기가 제한적, 자원에 따라 적당한 클러스터의 크기를 설정해야 함
	+ HDFS나 분산 키-값 저장소 같은 자체 저장소 시스템을 운영해야 함
	+ 상황에 따라 지리적 복제 및 재해 복구 체계 구축
+ 문제점 1 - 자원 활용 문제 해결 방법은 클러스터 매니저 사용
	+ 클러스터 매니저 사용 시 다수의 스파크 애플리케이션 실행 가능
	+ 애플리케이션 자원 동적 재할당 가능
	+ 동시에 여러 애플리케이션 실행 가능
		+ 동적 자원 공유 : YARN, 메소스 > 스탠드얼론 모드
	+ 자원 공유를 제어하는 것이 가장 큰 차이점
		+ 공개 클라우드는 애플리케이션에 맞는 규모의 클러스터를 할당해줌
+ 문제점 2, 3 - 저장소 시스템 사용으로 해결
	+ 하둡의 HDFS (분산 파일 시스템), 아파치 카산드라 (키-값 저장소 시스템) 주로 사용

### 17.1.2. 클라우드 배포 환경
- 설치형 클러스터 -> 클라우드 환경으로 진화
+ 클라우드 배포 환경의 장점 - 유연성
	+ 자원을 탄력적으로 늘이고 줄이는 것이 가능
		+ 막 써도 사용한 만큼 비용 지불하면 끝 ^^
		+ 딥러닝이 필요할 때만 GPU 인스턴스 할당받아 쓸 수 있음 (Jutopia)
	+ 공개 클라우드 환경은 비용이 저렴 + 지리적 복제 기능 지원함 -> 대규모 데이터 쉽게 관리
	+ 환경 관리를 따로 하지 않아도 됨
- AWS, Microsoft Azure, GCP
- 고정된 크기의 클러스터와 파일 시스템은 클라우드와 같은 유연한 시스템과 맞지 않음
	- 파일 시스템도 Amazon - S3, Azure Blob, Google Cloud와 같이 분리된 저장소 시스템을 사용해야 함
	- 스파크 워크로드마다 별도의 클러스터를 동적으로 할당해야 함
- 데이터브릭스에서 무료로 클라우드 배포 환경을 사용할 수 있음

## 17.2 클러스터 매니저
### 17.2.1 스탠드얼론 모드
- 스파크 워크로드용으로 특별히 제작된 경량화 플랫폼
- 간단하고 빠르게 환경을 구축, 스파크 어플리케이션만 사용하는 시스템에 적합
#### 스탠드얼론 클러스터 시작하기
``` C
$SPARK_HOME/sbin/start-master.sh 
```

