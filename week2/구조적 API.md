
### 4장. 구조적 API 개요

##### 개요 끄적 끄적
구조적 API는 비정형 로그 파일부터 반정형 CSV 파일 매우 정형적인 *파케이 파일끼지 다양한 유형의 데이터를 처리 할 수 있음. 배치와 스트리밍 처리에서 구조적 API 사용 가능.
구조적 API에 있는 분산 컬렉션 API
  1. Dataset
  2. DataFrame
  3. SQL 데이블과뷰
*파케이파일 : 파케이는 데이터를 저장하는 방식(파일포멧) 중 하나. 파케이는 하둡에서 운영되는 언어, 프레임워크에 제한되지 않는 모든 프로젝트에서 사용가능한 컬럼 기반의 저장 포멧입니다. 파케이는 트위터에서 개발한 파일 포멧이며, 소스코드를 공개한 이후 아파치에서 관리

이번장의 뽀인트는,
  1. 타입형(typed)/비타입형(untyped) API의 개념과치이점
	2. 핵심용어
	3. 스파크가 구조적 API의 데이터 흐름을 해석하고 클러스터에서 실행하는 방식

##### DataFrame/Dataset/스키마
- Dataframe과 Dataset은 잘 정의된 로우와 컬럼을 가지는 분산 데이블 형태의 컬렉션
- 스키마는 분산 컬렉션에 저장할 데이터 타입을 정의하는 방법, Data Frame에서 컬럼명과 데이터 타입을 정의

##### 스파크의 구조적 데이터 타입 개요

- 스피크는 실행 계획 수립과 처리에 사용하는 자체 데이터 타입 정보를 가지고 있는 키탈리스트 엔진을 사용.
- 파이썬이나 R을 이용해 스파크의 구조적 API를 사용하더리도 대부분의 연산은 피이썬이나 R의 데이터 타입이 아닌 스파크의 데이터 타입을 시용.
- 파이썬 코드를 수행 하더라도, 스피크에서 덧셈 연산이 수행되는 이유는 스파크가 지원하는 언어를 이용해 작성된 표현식을 카탈리스트 엔진에서 스파크의 데이터 타입으로 변환해 명령을 처리하기 때문

####### Dataframe VS Dataset
- DataFrame '비타입형', DataFrame에도 데이터 타입이 있습니다. 히지만 스키마에 명시된 데이터 타입의 일치 여부를 런타임이 되어서야 확인합니다. 
- Dataset은 '타입형', 스키마에 명시된 데이터 타입의 일치 여부를 컴파일 타임에 확인. Dataset은 JVM기반의 언어인 스칼라와 자바에서만 지원.
- 스피크의 DataFrame은 Row 타입으로 구성된 Dataset입니다. Row 타입은 스피크가 사용히는 ‘연산에 최적회된 인메모리 포맷'의 내부적인 표현 방식. 
- Row 타입을 사용하게 되면 매우 효율적인 연산이 가능, 지금 기억해야 할 것은 dataframe을 사용하면 스파크의 최적회된 내부 포맷을 시용할 수 있디는 사실. 스파크의 최적회된 내부 포맷을 시용하면 스파크가 지원하는 어떤 언어 API를 시용하더리도 동일한 효괴외. 효율성을 얻을 수 있습니다.

컬럼의 개념 : 정수,문자열 - 단순 데이터 타입, 배열, 맵 - 복합 데이터 타입 5장에서 자세히
로우의 개념 : 데이터 레코드
스파크데이터 타입 : 
# 스피크 데이 터 타입을 파이 썬에서 시용하려 면 다음과 같은 코드를 사용합니다

from pyspark.sql.types import *
b = ByteType()

4.4 구조적 API실행과정
이 절에서는 스피크 코드가 클러스터 에서 실제 처리되는 과정을 설명합니다
1 DataFrame/Dataset/SQL을 이용해 코드를 작성합니댜
2 정싱적인 코드라면 스파크가 논리적 실행 계획으로 변환합니댜
카탈리스트 옵티마이저가 수행 -> 3 스파크는 논리적 실행 계획을 물리적 실행 계획으로 변환하며 그 과정에서 추가적인 최적화를 할 수 있는지
확인합니댜
4 스파크는 클러스터에서 물리적 실행 계획 (RDD 처리 )을 실행합니다

	* 
논리적 실행 계획 : 추상적인 트랜스포메이션만! 사용자의 다양한 표현식을 최적화된 버전으로 변환(검증 전 논리적 실행 계획), data check
	* 
물리적 실행 계획 : 논리적 실행계획을 클러스터 환경에서 실행하는 방법. 비용을 계산해서 최적의 물리적 계획 선택하는데 예를들어 물리적 속성을 고려해 지정된 조인 연산 수행에 필요한 비용을 계산하고 비교. DataFrame, Data set, SQL로 정의된 쿼리를 RDD 트랜스포메이션으로 컴파일한다.
	* 
실행 : 저수준 프로그래밍 인터페이스인 RDD를 대싱으로 모든 코드를 실행





### 5장. 구조적 API 기본연산 
